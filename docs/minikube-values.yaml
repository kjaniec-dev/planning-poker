# Custom values for Planning Poker deployment on Minikube
# Deploy with: helm install my-planning-poker planning-poker/planning-poker -f minikube-values.yaml

# Planning Poker Configuration
planningPoker:
  # Deployment mode: external (separate WebSocket server)
  mode: external

  # WebSocket server language: golang (or node)
  language: golang

  # Environment variables
  env:
    # WebSocket server URL (will be auto-configured by the chart)
    realtimeUrl: ""

    # Redis configuration (optional - for horizontal scaling)
    # Uncomment to enable Redis-based scaling:
    # redisUrl: "redis://redis-master:6379"

    # Allowed origins for CORS (comma-separated)
    # Update with your minikube IP or domain
    allowedOrigins: ""

# Number of replicas
# For external mode with Redis, you can scale horizontally
replicaCount: 1

# Container image configuration
image:
  repository: kjaniec/planning-poker
  pullPolicy: IfNotPresent
  # Uses chart appVersion by default (1.0.5)
  tag: ""

# Service configuration
service:
  # NodePort for easy minikube access
  type: NodePort
  port: 3000
  targetPort: 3000

# Ingress configuration (disabled for minikube)
ingress:
  enabled: false

# Resource limits and requests
resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 512Mi

# Probes configuration
livenessProbe:
  httpGet:
    path: /
    port: http
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

# Autoscaling (disabled for basic minikube deployment)
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80

# Security context
podSecurityContext:
  fsGroup: 2000
  runAsNonRoot: true
  runAsUser: 1000

securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000
  allowPrivilegeEscalation: false